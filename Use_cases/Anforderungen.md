
## Monitoring the Grid  Flows

| Use-Case                                                                        | Kommunikationssimulator                                                                                                                                                                                                                                                                                                     | Netzsimulator                                                                                                                                                                                                                                                          | Co-Simulator                                                                                                                                                                                                                                                              | Testfaelle                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Assets                                                                                                                                               | Threats                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Data Acquisition and Control (DAC)                                              | Jeder vom Netz-Simulator erzeugte Messwert muss vom Kommunikaiontssimluator als InfoReport nach dem von TR-03109/FNN vorgegeben XML- oder JSON-Schema welches CMS-signiert ist ueber einen TLS-1.2/1.3-Kanal an das VNB-Backend uebertragen werden. Dabei muessen beide Seiten des TLS Kanals zertifikatauthentisiert sein. |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           | Im positiven Testfall, wird während eines 15-minütigen Betriebs mit nominalen Netzbedingungen jede Sekunde ein vom Stromnetz-Simulator berechneter InfoReport durch den Kommunikations-Simulator CMS-signiert und über einen TLS-1.2/1.3-Kanal mit beidseitiger Zertifikatsauthentisierung an das VNB-Backend übertragen. Dabei wird dieser schema-valide geparst und auf Korrektheit nach TR-03109 überprüft.<br><br>Im konkreten Negativ-Test ‚Schema-Verletzung‘ entfernt das Skript das Pflichtfeld unit aus einem InfoReport, injiziert den manipulierten Frame über denselben TLS-Kanal und erwartet, dass das SMGW den Frame verwirft, mit HTTP 400 Bad Request antwortet und den passenden FNN Fehlercode im zentralen Log protokolliert. | Smart Meter Gateway<br><br>CLS-Management Kommunikationsnetwerke<br><br>SCADA-System<br><br>Backende-System<br><br>Zertifkate und Schluesselmaterial | Manipulation von Messdaten (z.B. Man-in-the-Middle)<br><br>Replay-Attacken (Wiederholung von alten Messwerten)<br><br>Denial of Service (DoS) (z.B. Überflutung der Kommunikationsschnittstellen)<br><br>Manipulation von Steuerbefehlen (bei CLS-Management)<br><br>Unbefugter Zugriff auf Steuerfunktionen (Befehle absetzen)<br><br>Abgreifen sensibler Messdaten (Verletzung der Vertraulichkeit)<br><br>Missbrauch von Zertifikaten (z.B. Dienbstahl von privaten Schlüsseln) |
| SCADA Data Update                                                               | Jeder vom SCADA‑Backend kommende CLS/EMS‑Steuerbefehl muss vom Kommunikations‑Simulator gemäß TR‑03109‑5 in einem CMS‑signierten Control‑Message‑Container empfangen, auf Schema‑ und Signatur­gültigkeit geprüft und innerhalb von 500 ms an die Co‑Simulation übergeben werden.                                           | Der Stromnetz‑Simulator muss alle berechneten Spannungs‑, Strom‑, Leistungs‑ und Frequenzwerte mit zugehöriger OBIS‑Kennung und Einheit bereitstellen, damit der Kommunikations‑Simulator sie direkt in InfoReports einbetten kann (FNN Mikroprozesse, InfoReport‑DS). | Für jeden 1‑s‑Zeitschritt muss die Co‑Simulation erst den Stromnetz‑Simulator verarbeiten, dann den Kommunikations‑Simulator triggern und alle Ereignisse (InfoReport‑ID, Steuerbefehl, Netz‑Event) mit UTC‑Zeitstempel in einem gemeinsamen Log (CEF/JSON) persistieren. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| SGCG - Configure newly discovered device automatically to act within the system | Sobald der Kommunikations‑Simulator eine neu entdeckte LMN/HAN‑Komponente meldet, muss er ein CMS‑signiertes Device‑Onboarding‑Dokument via TLS‑1.2/1.3 mit beidseitiger SM‑PKI‑Zertifikatsauthentisierung an das Gateway‑Admin‑Backend übertragen                                                                          |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| SGCG - Discover a new component in the system                                   | Der Kommunikations‑Simulator muss periodisch einen DLMS/COSEM‑Association‑Scan auslösen und jedes entdeckte Gerät solange als 'untrusted' kennzeichnen, bis ein gültiges Geräte‑Zertifikat (TR‑03109‑4 Profil 4) geprüft ist und der erste InfoReport erfolgreich ausgetauscht wurde.                                       |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| SGCG - Generation forecast                                                      | Alle 15 min muss der Kommunikations‑Simulator eine CMS‑signierte 'GenerationForecast'‑Nachricht über eine TLS‑1.2/1.3‑Session an das VNB‑System schicken                                                                                                                                                                    |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

## Controlling the Grid

| Use-Case                                                                               | Anforderung Kommunikationssimulator                                                                                                                                                                                                                                                                                                                                                                            | Quellen                                                                           |
| -------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------- |
| NEDO – C1 Hierarchical Control of DMS                                                  | Hierarchische Last‑ und Erzeugungs‑Steuerbefehle (IEC 61850‑MMS 'Operate') müssen vom Kommunikations‑Simulator CMS‑signiert und über eine TLS‑1.3‑Verbindung mit beidseitiger SM‑PKI‑Authentisierung vom übergeordneten DMS an Micro‑DMS‑Gateways weitergeleitet und innerhalb von 500 ms quittiert werden; Prioritäts‑Attribute aus TR‑03109‑5 sind unverändert zu übernehmen.                                | TR‑03109‑5, IEC 61850‑7‑2, IEC 62351‑3/6, NEDO C1 Demo‑Specs                      |
| NEDO – C2 Hierarchical Control of EMS, EVECC, DMS & ¼‑DMS                              | Koordinierte Lade‑/Entlade‑Setpoints sind als CLS‑'TargetPower'‑Nachricht CMS‑signiert über TLS‑1.3 Session‑Resumption an alle EMS‑Gateways zu verteilen; jede Gateway‑ACK ist innerhalb von 1 s zu verarbeiten, andernfalls Wiederholversand bis zu drei Mal.                                                                                                                                                 | TR‑03109‑5, IEC 63110 / OpenADR 2.0b, IEC 62351‑3, NEDO C2 Leitfaden              |
| PAP08 – Distribution Grid Management (ADA) Functions                                   | Für Advanced Distribution Automation muss der Kommunikations‑Simulator IEC 61850‑GOOSE‑Frames (PDIS/PTRC/CSWI) TLS‑gekapselt (IEC 62351‑6) übertragen und verlorene Frames innerhalb von 20 ms erneut senden; ADA‑Optimierungs‑Befehle sind CMS‑signiert als MMS‑'Operate' zu übertragen.                                                                                                                      | IEEE PAP08 Guideline, IEC 61850‑90‑7, IEC 62351‑6, TR‑03109‑1                     |
| Wide‑Area Monitoring & Control - Automated Control Functions                           | Synchrophasor‑basierte Steuerbefehle (IEEE C37.118.2 'Command Frame') müssen in einem CMS‑Container über TLS‑1.3 mit Perfect‑Forward‑Secrecy an das Substation‑WAMS‑Backend gesendet werden; die End‑to‑End‑Latenz darf 150 ms nicht überschreiten, andernfalls Alarm‑Log.                                                                                                                                     | IEEE C37.118.2, IEC 62351‑5, TR‑03109‑1, ENTSO‑E WAMACS Best‑Practice             |
| Steuerung von Steuerbaren Verbrauchseinrichtung vom Verteilnetzbereiber nach §14a EnWG | Lastreduktions‑Befehle an steuerbare Verbrauchseinrichtungen (SE) müssen vom Kommunikations‑Simulator als CLS‑'LoadReduction'‑Nachricht nach TR‑03109‑5 CMS‑signiert und über eine TLS‑1.3‑Verbindung mit beidseitiger SM‑PKI‑Zertifikatsauthentisierung an das Kunden‑Gateway gesendet werden; das Gateway muss innerhalb von 30 s eine schema‑valide Bestätigung liefern, sonst Wiederholversand (max. 3 ×). | §14a EnWG, BDEW‑Lastmanagementprofil V3.0, TR‑03109‑5, IEC 62351‑3                |
| Engpassmanagement (Redispatch 2.0)                                                     | Redispatch‑Einspeise‑ oder Lastverschiebungs‑Vorgaben sind als XML‑Nachricht nach BK6‑20‑061 'RedispatchSetPoint' CMS‑signiert innerhalb von 5 min vor Einsatzzeitpunkt über TLS‑1.3 mit OCSP‑Stapling an alle betroffenen Anlagen‑Gateways zuzustellen; jede ACK ist binnen 60 s zu prüfen.                                                                                                                   | BK6‑20‑061 XML‑Spez., BNetzA‑Leitfaden Redispatch 2.0, TR‑03109‑1/‑5, IEC 62351‑3 |
| SGCG - DER remote control (dispatch)                                                   | P/Q‑Dispatch‑Setpoints für dezentrale Erzeugungsanlagen müssen als CLS‑'TargetPower'‑Nachricht CMS‑signiert über TLS‑1.2/1.3 mit Perfect‑Forward‑Secrecy an jedes DER‑Gateway gesendet werden; eine Quittung nach FNN‑Mikroprozesse (/control‑ack) ist innerhalb von 2 s zu validieren.                                                                                                                        | §14a EnWG, SGCG Framework, TR‑03109‑5, OpenADR 2.0b, IEC 62351‑3                  |
| SGCG - Supporting reclosing sequence                                                   | Siehe Monitoring Grid flow Cluster                                                                                                                                                                                                                                                                                                                                                                             |                                                                                   |
| SGCG - Supporting source switching                                                     | Siehe Monitoring Grid flow Cluster                                                                                                                                                                                                                                                                                                                                                                             |                                                                                   |
| SGCG - Discover a new component in the system                                          | Siehe Monitoring Grid flow Cluster                                                                                                                                                                                                                                                                                                                                                                             |                                                                                   |
| SGCG - Enable multiple concurrent levels of control (local-remote)                     | Der Kommunikations‑Simulator muss Steuerbefehle mit Prioritäts‑Tags (z. B. P0=lokal, P1=ferngesteuert) entgegennehmen, gemäß TR‑03109‑5 Arbiter‑Regel nach Priorität auflösen und nur den finalen CMS‑signierten Befehl über TLS‑1.3 an das Ziel‑Gateway weiterleiten; jeder abgewiesene Befehl ist mit einem 'ControlReject'‑Frame zu quittieren.                                                             | TR‑03109‑5, FNN CLS‑Arbiter, IEC 62351‑3, SGCG Control Levels Spec                |
| SGCG - Feeder load balancing                                                           | Load‑Balancing‑Anweisungen ('ChangeFeeder') müssen als CLS‑'SwitchLoad'‑Nachricht CMS‑signiert in einem Multicast‑ähnlichen TLS‑1.3‑Stream an alle betroffenen Gateway‑Knoten gesendet werden; mindestens 95 % der Gateways müssen innerhalb von 3 s eine schema‑valide Quittung liefern, sonst erneuter Versand.                                                                                              | TR‑03109‑5, IEC 61850‑90‑7, IEC 62351‑3, SGCG Feeder Balancing Use‑Case           |
| SGCG- Switch/breaker control                                                           | Schalt‑ und Leistungsschalter‑Befehle sind als IEC 61850‑[[Technologien und Algorithmen/Techniques/GOOSE]]‑Frame mit korrektem StNum/SeqNum‑Increment zu übertragen; der Kommunikations‑Simulator muss verlorene Frames alle 10 ms erneut senden, bis eine Bestätigung eintrifft, und den GOOSE‑Verkehr nach IEC 62351‑6 TLS‑tunneln, um TR‑03109‑1 Verschlüsselungs­anforderungen einzuhalten.                | IEC 61850‑7‑2/CSWI, IEC 62351‑6, TR‑03109‑1, SGCG Switch Control Guideline        |

## Grid Stability

| Use-Casse                                                                  | Anforderung                                                                                                                                                                                                                                                                                                                                                                                            | Quellen                                                                        |
| -------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------ |
| IP-1 ISO uses synchophasor data from grid operations, control and modeling | Synchrophasor‑Daten (IEEE C37.118.2 'Data Frame', 30 fps) sind CMS‑signiert über IEC 61850‑90‑5/UDP und TLS‑1.3 (IEC 62351‑5) an das ISO‑Control‑Center zu publizieren; Gegen­steuer‑Befehle ('Command Frame') müssen innerhalb 150 ms verarbeitet werden, um Post‑Event‑Stabilität sicherzustellen.                                                                                                   | IEEE C37.118.2, IEC 61850‑90‑5, IEC 62351‑5, NERC PRC‑002, TR‑03109‑1          |
| NEDO - Sendai Microgrid Use Case                                           | DER‑Spannungs‑ und Frequenz‑Streams (IEC 61850 LN MMXU) im 50 ms‑Raster werden CMS‑signiert via TLS‑1.3 an den Microgrid‑Controller übertragen; PQ‑Setpoints fließen als CLS‑'TargetPower' zurück und müssen binnen 500 ms bestätigt sein.                                                                                                                                                             | NEDO Sendai Specs, IEC 61850‑7‑4, TR‑03109‑5, IEC 62351‑3                      |
| ORNL F1 Frequencey Control                                                 | Frequenz sind als IEEE C37.118 'Data Frame' über TLS‑1.3 an SCADA zu senden; automatische Lastabwurfbefehle (OpenADR 2.0b 'LoadShed') sind CMS‑signiert binnen 100 ms an Last‑Gateways zu verteilen.                                                                                                                                                                                                   | ORNL µGrid F1, IEEE C37.118.2, OpenADR 2.0b, IEC 62351‑5, TR‑03109‑5           |
| Voltage Security                                                           | Phasormessungen (33 ms) müssen Unterspannung detektieren; binnen 200 ms ist ein CMS‑signierter IEC 61850‑GOOSE 'LoadShedding'‑Frame über TLS‑getunneltes GOOSE (IEC 62351‑6) an betroffene Breaker‑IEDs multicast‑artig zu senden.                                                                                                                                                                     | IEEE C37.118, IEC 61850‑CSWI, IEC 62351‑6, NERC TPL‑001, TR‑03109‑1            |
| Regelenergie für Sekundärregelleistung                                     | Automatic‑Frequency‑Restoration‑Reserve‑Setpoints (aFRR, 4‑s Takt) müssen als ENTSO‑E CIM IEC 61970‑452 'AGCSetPoint' CMS‑signiert über eine TLS‑1.3‑Verbindung (IEC 62351‑3) an die Regelkraftwerks‑Gateways gesendet werden; jede Gateway‑ACK ist innerhalb von 2 s zu verarbeiten, um Netzfrequenz‑Stabilität zu gewährleisten.                                                                     | ENTSO‑E GL Existing Reserves, IEC 61970‑452, IEC 62351‑3, TR‑03109‑5           |
| SGCG - Supporting time-stamped alarms management at all levels             | Der Kommunikations‑Simulator muss IEC 61850‑MMS‑Alarm‑Reports (LN SEMA, TimeQuality=0xC0) CMS‑signiert über TLS‑1.3 an alle Ebenen (Substation, DMS, SCADA) verteilen und eine End‑to‑End‑Zeitstempel‑Genauigkeit $\leq 1$ ms sicherstellen; verlorene Alarme sind innerhalb von 50 ms erneut zu senden.                                                                                               | IEC 61850‑7‑2/SEMA, IEC 62351‑3, SGCG Alarm UC, TR‑03109‑1                     |
| SGCG - Supporting automatic FLISR                                          | Für FLISR muss der Kommunikations‑Simulator Fault‑Indication‑GOOSE (LN PDIS/PTTR) binnen 20 ms CMS‑signiert über TLS‑getunneltes GOOSE (IEC 62351‑6) multicast‑artig übertragen und anschließend automatische Schaltbefehle (IEC 61850 CSWI 'Operate') innerhalb 100 ms an Recloser‑IEDs senden; die Wiedereinschaltung ist nach 300 ms zu bestätigen                                                  | IEC 61850‑GOOSE, IEC 62351‑6, IEEE P1409 FLISR Guide, SGCG FLISR UC            |
| SGCG - Supporting reclosing sequence                                       | Siehe Monitoring the Grid Flow Cluster                                                                                                                                                                                                                                                                                                                                                                 |                                                                                |
| SGCG - Supporting source switching                                         | Siehe Monitoring the Grid Flow Cluster                                                                                                                                                                                                                                                                                                                                                                 |                                                                                |
| SGCG - Shedding loads based on emergency signals                           | Bei Empfang eines Notfall‑Signals muss der Kommunikations‑Simulator binnen 100 ms eine CLS‑'LoadShed'‑Nachricht mit Prioritäts‑Tag (P0) CMS‑signiert über TLS‑1.3 (beidseitige SM‑PKI‑Auth) an alle lastschaltbaren Gateways senden; falls IEC 61850‑GOOSE genutzt wird, sind die Trip‑Frames TLS‑getunnelt nach IEC 62351‑6 zu multicasten und mindestens 95 % ACKs innerhalb 200 ms zu verifizieren. | SGCG Load Shed UC, TR‑03109‑5, IEC 61850‑CSWI/GOOSE, IEC 62351‑6, OpenADR 2.0b |


## Ueberschneidungen
| **Gemeinsame Anforderungsschablone**                                                    | Typische Formulierung (verkürzt)                                                          | **Doppelt bzw. identisch verwendet in …**                                                                                                                                                                                               |
| --------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **A. „CMS-signierte Nutzlast über TLS 1.2/1.3 mit beidseitiger SM-PKI-Auth“**           | _„<Message> CMS-signiert via TLS 1.2/1.3 (mutual authentication) an Backend senden.“_     | Fast alle Use-Cases (Configure device, Discovery, Generation Forecast, alle Control- und Grid-Stability-Fälle, Load-Shedding, Redispatch 2.0, §14a SE etc.). → Das ist die **Basis-Transportanforderung** jeder TR-03109-Kommunikation. |
| **B. CLS-ControlMessage: `TargetPower` / `LoadReduction` + Gateway-ACK ≤ x s**          | _„CLS-Nachricht CMS-signiert senden; Gateway muss ≤ 2–3 s quittieren, sonst Retransmit.“_ | NEDO-C2, DER remote control, Feeder load balancing, §14a-SE, Load-Shedding, Redispatch 2.0. Unterschied oft nur in Timeout (1 s vs 3 s) – fachlich identisch.                                                                           |
| **C. IEC 61850-GOOSE (+ TLS-Tunnel IEC 62351-6) mit Retransmit ≤ 10–20 ms**             | _„GOOSE-Trip/Operate versenden; verlorene Frames alle x ms erneut senden.“_               | Switch / Breaker control, FLISR, Voltage Security, Supporting reclosing sequence. → Gleicher Mechanismus, nur unterschiedliche Auslöser.                                                                                                |
| **D. Synchrophasor-Streaming (IEEE C37.118 Data + Command Frames über 61850-90-5/TLS)** | _„PMU-Data Frames @ 30–60 fps übertragen; Command-ACK ≤ 150 ms.“_                         | IP-1 (ISO WAMS), ORNL F1 Frequency Control. → Inhalt, Frame-Rate variieren leicht, Protokoll-Stack identisch.                                                                                                                           |
| **E. Geräte-Onboarding & Zertifikats-OCSP-Prüfung**                                     | _„Neues Gerät bleibt ‹untrusted› bis Cert OCSP-validiert & 1. InfoReport erfolgreich.“_   | Configure newly discovered device, Discover new component (SGCG), Änderungs-Discovery in Control-Cluster.                                                                                                                               |
| **F. Mehrstufige Priorisierung / Arbitration (P0 lokal > Px remote)**                   | _„Befehle mit Prior-Tag sortieren, nur höchsten weiterleiten, Reject für Rest.“_          | Enable multiple concurrent levels of control + sämtliche CLS-Arbiter-Szenarien.                                                                                                                                                         |
| **G. Multicast-ähnliche Distribution an Gateway-Gruppe mit ≥ 95 % ACK**                 | _„Befehl an Gateway-Gruppe senden, 95 % ACK ≤ 3 s, sonst Wiederholung.“_                  | Feeder load balancing, Load-Shedding.                                                                                                                                                                                                   |

### Fazit
- **A** ist das **generische Transport-Grundgerüst** – einmal sauber definiert, gilt es für 90 % aller Anforderungen.
- **B**, **C**, **D** und **E** sind **wiederkehrende Funktionsblöcke**, die du als Template implementieren und nur mit Use-Case-spezifischen Parametern (Timeout, Frame-Rate, Payload-Typ) instanziieren musst.
- **F** und **G** sind Spezialmuster, die zwar weniger Use-Cases betreffen, aber ebenfalls jeweils identisch aufgebaut sind.
- 