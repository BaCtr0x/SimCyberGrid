
## Monitoring the Grid  Flows

| Use-Case                                                                        | Kommunikationssimulator                                                                                                                                                                                                                                                                                                     | Netzsimulator                                                                                                                                                                                                                                                          | Co-Simulator                                                                                                                                                                                                                                                              | Testfaelle                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Assets                                                                                                                                               | Threats                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Data Acquisition and Control (DAC)                                              | Jeder vom Netz-Simulator erzeugte Messwert muss vom Kommunikaiontssimluator als InfoReport nach dem von TR-03109/FNN vorgegeben XML- oder JSON-Schema welches CMS-signiert ist ueber einen TLS-1.2/1.3-Kanal an das VNB-Backend uebertragen werden. Dabei muessen beide Seiten des TLS Kanals zertifikatauthentisiert sein. |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           | Im positiven Testfall, wird während eines 15-minütigen Betriebs mit nominalen Netzbedingungen jede Sekunde ein vom Stromnetz-Simulator berechneter InfoReport durch den Kommunikations-Simulator CMS-signiert und über einen TLS-1.2/1.3-Kanal mit beidseitiger Zertifikatsauthentisierung an das VNB-Backend übertragen. Dabei wird dieser schema-valide geparst und auf Korrektheit nach TR-03109 überprüft.<br><br>Im konkreten Negativ-Test ‚Schema-Verletzung‘ entfernt das Skript das Pflichtfeld unit aus einem InfoReport, injiziert den manipulierten Frame über denselben TLS-Kanal und erwartet, dass das SMGW den Frame verwirft, mit HTTP 400 Bad Request antwortet und den passenden FNN Fehlercode im zentralen Log protokolliert. | Smart Meter Gateway<br><br>CLS-Management Kommunikationsnetwerke<br><br>SCADA-System<br><br>Backende-System<br><br>Zertifkate und Schluesselmaterial | Manipulation von Messdaten (z.B. Man-in-the-Middle)<br><br>Replay-Attacken (Wiederholung von alten Messwerten)<br><br>Denial of Service (DoS) (z.B. Überflutung der Kommunikationsschnittstellen)<br><br>Manipulation von Steuerbefehlen (bei CLS-Management)<br><br>Unbefugter Zugriff auf Steuerfunktionen (Befehle absetzen)<br><br>Abgreifen sensibler Messdaten (Verletzung der Vertraulichkeit)<br><br>Missbrauch von Zertifikaten (z.B. Dienbstahl von privaten Schlüsseln) |
| SCADA Data Update                                                               | Jeder vom SCADA‑Backend kommende CLS/EMS‑Steuerbefehl muss vom Kommunikations‑Simulator gemäß TR‑03109‑5 in einem CMS‑signierten Control‑Message‑Container empfangen, auf Schema‑ und Signatur­gültigkeit geprüft und innerhalb von 500 ms an die Co‑Simulation übergeben werden.                                           | Der Stromnetz‑Simulator muss alle berechneten Spannungs‑, Strom‑, Leistungs‑ und Frequenzwerte mit zugehöriger OBIS‑Kennung und Einheit bereitstellen, damit der Kommunikations‑Simulator sie direkt in InfoReports einbetten kann (FNN Mikroprozesse, InfoReport‑DS). | Für jeden 1‑s‑Zeitschritt muss die Co‑Simulation erst den Stromnetz‑Simulator verarbeiten, dann den Kommunikations‑Simulator triggern und alle Ereignisse (InfoReport‑ID, Steuerbefehl, Netz‑Event) mit UTC‑Zeitstempel in einem gemeinsamen Log (CEF/JSON) persistieren. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| SGCG - Configure newly discovered device automatically to act within the system | Sobald der Kommunikations‑Simulator eine neu entdeckte LMN/HAN‑Komponente meldet, muss er ein CMS‑signiertes Device‑Onboarding‑Dokument via TLS‑1.2/1.3 mit beidseitiger SM‑PKI‑Zertifikatsauthentisierung an das Gateway‑Admin‑Backend übertragen                                                                          |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| SGCG - Discover a new component in the system                                   | Der Kommunikations‑Simulator muss periodisch einen DLMS/COSEM‑Association‑Scan auslösen und jedes entdeckte Gerät solange als 'untrusted' kennzeichnen, bis ein gültiges Geräte‑Zertifikat (TR‑03109‑4 Profil 4) geprüft ist und der erste InfoReport erfolgreich ausgetauscht wurde.                                       |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| SGCG - Generation forecast                                                      | Alle 15 min muss der Kommunikations‑Simulator eine CMS‑signierte 'GenerationForecast'‑Nachricht über eine TLS‑1.2/1.3‑Session an das VNB‑System schicken                                                                                                                                                                    |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

## Controlling the Grid

| Use-Case                                                                               | Anforderung Kommunikationssimulator                                                                                                                                                                                                                                                                                                                                                                            | Quellen                                                                           |
| -------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------- |
| NEDO – C1 Hierarchical Control of DMS                                                  | Hierarchische Last‑ und Erzeugungs‑Steuerbefehle (IEC 61850‑MMS 'Operate') müssen vom Kommunikations‑Simulator CMS‑signiert und über eine TLS‑1.3‑Verbindung mit beidseitiger SM‑PKI‑Authentisierung vom übergeordneten DMS an Micro‑DMS‑Gateways weitergeleitet und innerhalb von 500 ms quittiert werden; Prioritäts‑Attribute aus TR‑03109‑5 sind unverändert zu übernehmen.                                | TR‑03109‑5, IEC 61850‑7‑2, IEC 62351‑3/6, NEDO C1 Demo‑Specs                      |
| NEDO – C2 Hierarchical Control of EMS, EVECC, DMS & ¼‑DMS                              | Koordinierte Lade‑/Entlade‑Setpoints sind als CLS‑'TargetPower'‑Nachricht CMS‑signiert über TLS‑1.3 Session‑Resumption an alle EMS‑Gateways zu verteilen; jede Gateway‑ACK ist innerhalb von 1 s zu verarbeiten, andernfalls Wiederholversand bis zu drei Mal.                                                                                                                                                 | TR‑03109‑5, IEC 63110 / OpenADR 2.0b, IEC 62351‑3, NEDO C2 Leitfaden              |
| PAP08 – Distribution Grid Management (ADA) Functions                                   | Für Advanced Distribution Automation muss der Kommunikations‑Simulator IEC 61850‑GOOSE‑Frames (PDIS/PTRC/CSWI) TLS‑gekapselt (IEC 62351‑6) übertragen und verlorene Frames innerhalb von 20 ms erneut senden; ADA‑Optimierungs‑Befehle sind CMS‑signiert als MMS‑'Operate' zu übertragen.                                                                                                                      | IEEE PAP08 Guideline, IEC 61850‑90‑7, IEC 62351‑6, TR‑03109‑1                     |
| Wide‑Area Monitoring & Control - Automated Control Functions                           | Synchrophasor‑basierte Steuerbefehle (IEEE C37.118.2 'Command Frame') müssen in einem CMS‑Container über TLS‑1.3 mit Perfect‑Forward‑Secrecy an das Substation‑WAMS‑Backend gesendet werden; die End‑to‑End‑Latenz darf 150 ms nicht überschreiten, andernfalls Alarm‑Log.                                                                                                                                     | IEEE C37.118.2, IEC 62351‑5, TR‑03109‑1, ENTSO‑E WAMACS Best‑Practice             |
| Steuerung von Steuerbaren Verbrauchseinrichtung vom Verteilnetzbereiber nach §14a EnWG | Lastreduktions‑Befehle an steuerbare Verbrauchseinrichtungen (SE) müssen vom Kommunikations‑Simulator als CLS‑'LoadReduction'‑Nachricht nach TR‑03109‑5 CMS‑signiert und über eine TLS‑1.3‑Verbindung mit beidseitiger SM‑PKI‑Zertifikatsauthentisierung an das Kunden‑Gateway gesendet werden; das Gateway muss innerhalb von 30 s eine schema‑valide Bestätigung liefern, sonst Wiederholversand (max. 3 ×). | §14a EnWG, BDEW‑Lastmanagementprofil V3.0, TR‑03109‑5, IEC 62351‑3                |
| Engpassmanagement (Redispatch 2.0)                                                     | Redispatch‑Einspeise‑ oder Lastverschiebungs‑Vorgaben sind als XML‑Nachricht nach BK6‑20‑061 'RedispatchSetPoint' CMS‑signiert innerhalb von 5 min vor Einsatzzeitpunkt über TLS‑1.3 mit OCSP‑Stapling an alle betroffenen Anlagen‑Gateways zuzustellen; jede ACK ist binnen 60 s zu prüfen.                                                                                                                   | BK6‑20‑061 XML‑Spez., BNetzA‑Leitfaden Redispatch 2.0, TR‑03109‑1/‑5, IEC 62351‑3 |
| SGCG - DER remote control (dispatch)                                                   | P/Q‑Dispatch‑Setpoints für dezentrale Erzeugungsanlagen müssen als CLS‑'TargetPower'‑Nachricht CMS‑signiert über TLS‑1.2/1.3 mit Perfect‑Forward‑Secrecy an jedes DER‑Gateway gesendet werden; eine Quittung nach FNN‑Mikroprozesse (/control‑ack) ist innerhalb von 2 s zu validieren.                                                                                                                        | §14a EnWG, SGCG Framework, TR‑03109‑5, OpenADR 2.0b, IEC 62351‑3                  |
| SGCG - Supporting reclosing sequence                                                   | Siehe Monitoring Grid flow Cluster                                                                                                                                                                                                                                                                                                                                                                             |                                                                                   |
| SGCG - Supporting source switching                                                     | Siehe Monitoring Grid flow Cluster                                                                                                                                                                                                                                                                                                                                                                             |                                                                                   |
| SGCG - Discover a new component in the system                                          | Siehe Monitoring Grid flow Cluster                                                                                                                                                                                                                                                                                                                                                                             |                                                                                   |
| SGCG - Enable multiple concurrent levels of control (local-remote)                     | Der Kommunikations‑Simulator muss Steuerbefehle mit Prioritäts‑Tags (z. B. P0=lokal, P1=ferngesteuert) entgegennehmen, gemäß TR‑03109‑5 Arbiter‑Regel nach Priorität auflösen und nur den finalen CMS‑signierten Befehl über TLS‑1.3 an das Ziel‑Gateway weiterleiten; jeder abgewiesene Befehl ist mit einem 'ControlReject'‑Frame zu quittieren.                                                             | TR‑03109‑5, FNN CLS‑Arbiter, IEC 62351‑3, SGCG Control Levels Spec                |
| SGCG - Feeder load balancing                                                           | Load‑Balancing‑Anweisungen ('ChangeFeeder') müssen als CLS‑'SwitchLoad'‑Nachricht CMS‑signiert in einem Multicast‑ähnlichen TLS‑1.3‑Stream an alle betroffenen Gateway‑Knoten gesendet werden; mindestens 95 % der Gateways müssen innerhalb von 3 s eine schema‑valide Quittung liefern, sonst erneuter Versand.                                                                                              | TR‑03109‑5, IEC 61850‑90‑7, IEC 62351‑3, SGCG Feeder Balancing Use‑Case           |
| SGCG- Switch/breaker control                                                           | Schalt‑ und Leistungsschalter‑Befehle sind als IEC 61850‑[[Technologien und Algorithmen/Techniques/GOOSE]]‑Frame mit korrektem StNum/SeqNum‑Increment zu übertragen; der Kommunikations‑Simulator muss verlorene Frames alle 10 ms erneut senden, bis eine Bestätigung eintrifft, und den GOOSE‑Verkehr nach IEC 62351‑6 TLS‑tunneln, um TR‑03109‑1 Verschlüsselungs­anforderungen einzuhalten.                | IEC 61850‑7‑2/CSWI, IEC 62351‑6, TR‑03109‑1, SGCG Switch Control Guideline        |

## Grid Stability

| Use-Casse                                                                  | Anforderung                                                                                                                                                                                                                                                                                                                                                                                            | Quellen                                                                        |
| -------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------ |
| IP-1 ISO uses synchophasor data from grid operations, control and modeling | Synchrophasor‑Daten (IEEE C37.118.2 'Data Frame', 30 fps) sind CMS‑signiert über IEC 61850‑90‑5/UDP und TLS‑1.3 (IEC 62351‑5) an das ISO‑Control‑Center zu publizieren; Gegen­steuer‑Befehle ('Command Frame') müssen innerhalb 150 ms verarbeitet werden, um Post‑Event‑Stabilität sicherzustellen.                                                                                                   | IEEE C37.118.2, IEC 61850‑90‑5, IEC 62351‑5, NERC PRC‑002, TR‑03109‑1          |
| NEDO - Sendai Microgrid Use Case                                           | DER‑Spannungs‑ und Frequenz‑Streams (IEC 61850 LN MMXU) im 50 ms‑Raster werden CMS‑signiert via TLS‑1.3 an den Microgrid‑Controller übertragen; PQ‑Setpoints fließen als CLS‑'TargetPower' zurück und müssen binnen 500 ms bestätigt sein.                                                                                                                                                             | NEDO Sendai Specs, IEC 61850‑7‑4, TR‑03109‑5, IEC 62351‑3                      |
| ORNL F1 Frequencey Control                                                 | Frequenz sind als IEEE C37.118 'Data Frame' über TLS‑1.3 an SCADA zu senden; automatische Lastabwurfbefehle (OpenADR 2.0b 'LoadShed') sind CMS‑signiert binnen 100 ms an Last‑Gateways zu verteilen.                                                                                                                                                                                                   | ORNL µGrid F1, IEEE C37.118.2, OpenADR 2.0b, IEC 62351‑5, TR‑03109‑5           |
| Voltage Security                                                           | Phasormessungen (33 ms) müssen Unterspannung detektieren; binnen 200 ms ist ein CMS‑signierter IEC 61850‑GOOSE 'LoadShedding'‑Frame über TLS‑getunneltes GOOSE (IEC 62351‑6) an betroffene Breaker‑IEDs multicast‑artig zu senden.                                                                                                                                                                     | IEEE C37.118, IEC 61850‑CSWI, IEC 62351‑6, NERC TPL‑001, TR‑03109‑1            |
| Regelenergie für Sekundärregelleistung                                     | Automatic‑Frequency‑Restoration‑Reserve‑Setpoints (aFRR, 4‑s Takt) müssen als ENTSO‑E CIM IEC 61970‑452 'AGCSetPoint' CMS‑signiert über eine TLS‑1.3‑Verbindung (IEC 62351‑3) an die Regelkraftwerks‑Gateways gesendet werden; jede Gateway‑ACK ist innerhalb von 2 s zu verarbeiten, um Netzfrequenz‑Stabilität zu gewährleisten.                                                                     | ENTSO‑E GL Existing Reserves, IEC 61970‑452, IEC 62351‑3, TR‑03109‑5           |
| SGCG - Supporting time-stamped alarms management at all levels             | Der Kommunikations‑Simulator muss IEC 61850‑MMS‑Alarm‑Reports (LN SEMA, TimeQuality=0xC0) CMS‑signiert über TLS‑1.3 an alle Ebenen (Substation, DMS, SCADA) verteilen und eine End‑to‑End‑Zeitstempel‑Genauigkeit $\leq 1$ ms sicherstellen; verlorene Alarme sind innerhalb von 50 ms erneut zu senden.                                                                                               | IEC 61850‑7‑2/SEMA, IEC 62351‑3, SGCG Alarm UC, TR‑03109‑1                     |
| SGCG - Supporting automatic FLISR                                          | Für FLISR muss der Kommunikations‑Simulator Fault‑Indication‑GOOSE (LN PDIS/PTTR) binnen 20 ms CMS‑signiert über TLS‑getunneltes GOOSE (IEC 62351‑6) multicast‑artig übertragen und anschließend automatische Schaltbefehle (IEC 61850 CSWI 'Operate') innerhalb 100 ms an Recloser‑IEDs senden; die Wiedereinschaltung ist nach 300 ms zu bestätigen                                                  | IEC 61850‑GOOSE, IEC 62351‑6, IEEE P1409 FLISR Guide, SGCG FLISR UC            |
| SGCG - Supporting reclosing sequence                                       | Siehe Monitoring the Grid Flow Cluster                                                                                                                                                                                                                                                                                                                                                                 |                                                                                |
| SGCG - Supporting source switching                                         | Siehe Monitoring the Grid Flow Cluster                                                                                                                                                                                                                                                                                                                                                                 |                                                                                |
| SGCG - Shedding loads based on emergency signals                           | Bei Empfang eines Notfall‑Signals muss der Kommunikations‑Simulator binnen 100 ms eine CLS‑'LoadShed'‑Nachricht mit Prioritäts‑Tag (P0) CMS‑signiert über TLS‑1.3 (beidseitige SM‑PKI‑Auth) an alle lastschaltbaren Gateways senden; falls IEC 61850‑GOOSE genutzt wird, sind die Trip‑Frames TLS‑getunnelt nach IEC 62351‑6 zu multicasten und mindestens 95 % ACKs innerhalb 200 ms zu verifizieren. | SGCG Load Shed UC, TR‑03109‑5, IEC 61850‑CSWI/GOOSE, IEC 62351‑6, OpenADR 2.0b |


## Blackout Management

| Use-Case                                   | Anforderung                                                                                                                                                                                                                                                                                                                                                                   | Quellen                                                                                 |
| ------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------- |
| SGCG – Black‑out prevention through WAMPAC | Synchrophasor‑Streams (IEEE C37.118.2, 50 fps) sind CMS‑signiert via IEC 61850‑90‑5/UDP und TLS 1.3 (IEC 62351‑5) an das WAMPAC‑Backend zu schicken; erkennt das Backend Instabilität, muss der Kommunikations‑Simulator binnen 100 ms IEC 61850‑GOOSE‑Trip‑Frames TLS‑getunnelt multicast‑artig an Schutz‑IEDs senden und ≥95 % Bestätigungen innerhalb 200 ms verifizieren. | IEEE C37.118.2; IEC 61850‑90‑5; IEC 62351‑5/6; NERC PRC‑002; TR‑03109‑1; SGCG WAMPAC UC |
| SGCG – Restore power after black‑out       | Im Black‑Start‑Szenario muss der Kommunikations‑Simulator sequenzielle 'BlackStartCommand'‑Telegramme (IEC 61850‑MMS, LN SSPC/GENC) CMS‑signiert über TLS 1.3 mit SM‑PKI‑Auth an Start‑Generatoren und Schalter senden; jede Stufe ist durch ein Gateway‑ACK ≤2 s zu bestätigen, bevor die nächste Schaltstufe ausgelöst wird.                                                | IEC 61850‑7‑2; NERC EOP‑005; IEC 62351‑3; TR‑03109‑5; SGCG Black‑Start UC               |
| AEP OMS Poll – Multicast/Unicast           | Zur Ausfallermittlung muss der Kommunikations‑Simulator eine 'PowerStatusPoll' gemäß ANSI C12.22/DLMS COSEM multicast‑fähig CMS‑signiert über TLS 1.2/1.3 senden und binnen 60 s ≥90 % Unicast‑Antworten verarbeiten; fehlende Antworten lösen einen Wiederhol‑Poll nach 120 s aus.                                                                                           | ANSI C12.22; DLMS COSEM; AEP OMS Spec; IEC 62351‑3; TR‑03109‑1                          |

## Exchange of Metering Data

| Use Case                          | Anforderungen                                                                                                                                                                                                                                                                                   | Quellen                                                                                                                                                                         |
| --------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| AEP – Operational Data Store / SG | Aggregierte, pseudonymisierte Messdaten‑Batches (IEC 61968‑9 CIM XML ‘MeterReading’) sind CMS‑signiert per HTTPS‑TLS 1.3 (mutual SM‑PKI) an den ODS zu liefern; der Simulator muss vor Upload ein HMAC‑basierte Pseudonymisierung (SHA‑256 Salt) durchführen und eine 200‑OK‑Bestätigung        | Die beiden Metering-Data-Use-Cases sind mit passenden Kommunikations-Simulator-Anforderungen und Quellen erstellt.  <br>Download »Kommunikations-Simulator – Metering Data UCs« |
| ORNL – F10 Microgrid UI & Data    | Echtzeit‑Messwerte (IEC 61850 LN MMXU) sind im 1 s‑Raster via WebSocket‑TLS 1.3 an die UI zu pushen, während Nicht‑Echtzeit‑Dumps als OPC UA Binary über HTTPS‑TLS in die Historian‑Datenbank geschrieben werden; jede Insert‑Operation benötigt eine positive OPC UA ‘ServiceResult’‑ACK ≤1 s. | IEC 61850‑7‑2; OPC UA IEC 62541‑6; IEC 62351‑3; ORNL F10 Spec; TR‑03109‑1                                                                                                       |

## Operate DER


| Use-Case                                                          | Anforderungen                                                                                                                                                                                                                                                                                                                                                                                                                                    | Quellen                                                                                |
| ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------- |
| IS‑1 – Energy storage for grid operations & control               | Der Kommunikations‑Simulator muss Lade/Entlade‑Setpoints (CLS 'TargetPower', P+/P−, SOC‑Limit) CMS‑signiert über TLS 1.3 Session‑Resumption an alle Speicher‑Gateways senden und innerhalb 2 s eine Gateway‑ACK verifizieren; Messwerte retour sind im 1 s‑Raster als IEC 61850‑MMS Report (LN BESS) zu streamen.                                                                                                                                | TR‑03109‑5; IEC 61850‑7‑420 (BESS); IEC 62351‑3; OpenADR 2.0b; IEEE 2030.5             |
| NEDO – BEMS control of DER & HVAC for islanding/DR                | Demand‑Response‑Events (OpenADR 'oadrDistributeEvent') sind CMS‑signiert via TLS 1.3 an das BEMS‑Gateway zu senden; das BEMS muss binnen 5 s CLS‑'LoadReduction' oder 'TargetPower' Befehle an HVAC‑Controller und PV/Battery‑Inverter zurückmelden, welche der Simulator als separate TLS‑Streams an die jeweiligen Device‑Gateways verteilt.                                                                                                   | OpenADR 2.0b; TR‑03109‑5; IEC 62351‑3; NEDO BEMS Specs<br>                             |
| NEDO – Online control by Battery Aggregation (Virtual ES)         | Der Kommunikations‑Simulator muss Aggregations‑Setpoints (ΣP, ΣQ, SOC‑Window) CMS‑signiert als IEC 63110 'SetChargingProfile' über HTTPS‑TLS 1.3 an alle dezentralen Battery‑Gateways schicken; mindestens 90 % Quittungen sind ≤3 s zu verarbeiten, anderenfalls Retry.                                                                                                                                                                         | IEC 63110; TR‑03109‑5; IEC 62351‑14; NEDO Virtual ES Guide                             |
| NEDO – A1 Energy Management of grid‑connected microgrid           | Für den optimalen Gas‑&‑Strom‑Betrieb muss der Kommunikations‑Simulator Betriebsdaten (Gas‑Flow, Elektro‑P/Q) als OPC UA PubSub über TLS 1.3 an den µEMS leiten und Dispatch‑Befehle aus dem µEMS als CLS 'TargetPower' oder Modbus‑TCP Write (Holding Register) innerhalb 1 s an Generator‑Gateways verteilen.                                                                                                                                  | OPC UA PubSub IEC 62541‑14; Modbus TCP; TR‑03109‑5; IEC 62351‑3; NEDO A1 Spec          |
| NEDO – H1 Energy management of grid‑connected microgrid (Biomass) | Dispatch‑Setpoints für Biomasse‑Generatoren (P, Q, Ramp‑Rate) sind CMS‑signiert als IEC 61850‑MMS 'Operate'‑Service (LN GENC) über TLS 1.3 (IEC 62351‑3) an die Generator‑Gateways zu senden; Prozess‑Daten (Fuel‑Flow, kW, kvar) müssen im 1 s‑Raster als OPC UA PubSub an den µEMS gestreamt und jede Service‑ACK ≤1 s verifiziert werden.                                                                                                     | IEC 61850‑7‑420; IEC 62541‑14 OPC UA PubSub; IEC 62351‑3; TR‑03109‑5; NEDO H1 Spec<br> |
| NEDO – Peak Shifting by Battery Aggregation                       | Für Peak‑Shifting muss der Kommunikations‑Simulator Day‑Ahead Lade/Entlade‑Schedule (OpenADR 2.0b ‘oadrDistributeEvent’ with Schedule Payload) CMS‑signiert via TLS 1.3 an alle Battery‑Gateways senden; Gateways liefern SOC‑Telemetrie im 5 s‑Raster zurück und müssen jeweils eine Event‑ACK ≤2 s bereitstellen.                                                                                                                              | OpenADR 2.0b; IEC 63110; IEC 62351‑3; TR‑03109‑5; NEDO Peak Shift Guide                |
| PAP11 – PEV impact on distribution operations                     | Der Kommunikations‑Simulator muss nahezu Echtzeit‑Ladeleistungen von PEV‑Ladestationen (IEC 63110 ‘MeterValues’) im 1 s‑Raster an das DMS‑SCADA übermitteln und CLS‑‘TargetPower’‑Befehle zur Lade‑Reduktion oder Vehicle‑to‑Grid‑Abgabe CMS‑signiert über TLS 1.3 an die Stationen leiten; Quittung ≤1 s ist zu verifizieren.                                                                                                                   | IEC 63110; SAE J2847/20; IEEE 2030.5; TR‑03109‑5; IEEE PAP11 Doc                       |
| Utility‑Customer PV + Storage optimisation                        | PV‑Leistung und Batteriespeicher‑Status werden via IEEE 2030.5 ‘DERControl’/‘DERStatus’ alle 30 s an den Utility‑DERMS übertragen; Kostenoptimierungs‑Setpoints (P/Q oder Time‑Of‑Use‑Schedule) sind CMS‑signiert als SunSpec Modbus TCP Write über TLS 1.3 an den Customer‑Energy‑Gateway zu senden und eine Modbus‑ACK binnen 1 s zu prüfen.                                                                                                   | IEEE 2030.5; SunSpec Modbus; IEC 62351‑5; TR‑03109‑5; Utility‑DER Storage Spec         |
| Aggregated Prosumer Management                                    | Prosumer‑Messwerte (PV‑Erzeugung, Hauslast, SOC) sind im 30 s‑Raster als IEEE 2030.5 ‘MeterReading’ CMS‑signiert via HTTPS‑TLS 1.3 (beidseitige SM‑PKI) an den Prosumer‑Aggregator zu übertragen; der Aggregator sendet Day‑Ahead Self‑Consumption‑Schedules als IEEE 2030.5 ‘DERControl’ bzw. OpenADR 2.0b ‘oadrDistributeEvent’, die der Simulator innerhalb von 2 s quittiert.;                                                               | IEEE 2030.5; OpenADR 2.0b; IEC 62351‑3; TR‑03109‑5; EN 50549‑10                        |
| Vehicle‑to‑Grid (Bidirektionales Laden)                           | Bidirektionale Lade-/Entlade‑Setpoints sind CMS‑signiert als ISO 15118‑20 ‘ScheduleExchange’ über TLS 1.3 (V2G‑Root CA) an EVSE‑Gateways zu senden; IEC 63110 ‘MeterValues’ mit tatsächlicher P/Q werden im 1 s‑Raster zurückgeliefert und eine ‘ChargingStatusACK’ ≤1 s verifiziert.                                                                                                                                                            | ISO 15118‑20; IEC 63110; IEC 62351‑3; TR‑03109‑5; SAE J2847/3                          |
| SGCG – Aggregate DER as commercial VPP                            | Aggregierte Produktionsprognosen und Day‑Ahead‑Schedules sind als IEC 62325‑351 CIM ‘ScheduleMessage’ CMS‑signiert via AS4/ebMS3 über HTTPS‑TLS 1.3 an den Marktbetreiber zu senden; der Simulator muss DER‑Setpoints (CLS ‘TargetPower’) entsprechend auf einzelne Gateways verteilen und ≥95 % ACKs ≤3 s verifizieren.                                                                                                                         | IEC 62325‑351; ENTSO‑E ESS; AS4 Profile; TR‑03109‑5; SGCG VPP Commercial UC            |
| SGCG – Aggregate DER as technical VPP                             | Der Kommunikations‑Simulator muss Sammel‑InfoReports (ΣP, ΣQ, VoltageMargin) nach FNN‑Schema CMS‑signiert via TLS 1.3 an das DSO‑DMS senden und granular aufgelöste CLS‑Setpoints an zugehörige DER‑Gateways verteilen; der DSO‑ACK ist ≤2 s zu prüfen.                                                                                                                                                                                          | FNN Mikroprozesse; TR‑03109‑5; IEC 62351‑3; SGCG VPP Technical UC; IEC 61850‑7‑420     |
| SGCG – Registration / Deregistration of DER in VPP                | Der Kommunikations‑Simulator muss ‘RegisterDER’‑ und ‘DeregisterDER’‑Nachrichten (IEC 63110 DeviceProvisioning) CMS‑signiert via HTTPS‑TLS 1.3 an das VPP‑Operator‑Backend senden; das Backend liefert ein Enrollment‑Token, das binnen 60 s von den zugehörigen DER‑Gateways als CLS ‘EnrollAck’ zurückgemeldet werden muss.                                                                                                                    | EEG §9 Abs 2; BDEW‑Lastmanagement V3.0; TR‑03109‑5; IEC 62351‑3                        |
| SGCG – DER performance management                                 | Leistungs‑KPIs (Wirklast‑Faktor, Verfügbarkeit, Temperatursensoren) sind im 60 s‑Raster als IEEE 2030.5 ‘DERTelemetry’ CMS‑signiert via TLS 1.3 an das DER‑Performance‑Portal zu übertragen; Alarm‑Threshold‑Updates kommen als OpenADR 2.0b ‘oadrDistributeEvent’ und müssen binnen 2 s quittiert werden.                                                                                                                                       | TR‑03109‑5; OpenADR 2.0b ‘LoadShed’; IEC 62351‑3; SGCG ReducedPower UC                 |
| SGCG – DER process management                                     | Start/Stop‑ und Maintenance‑Befehle sind CMS‑signiert als IEC 61850‑MMS ‘Operate’ (LN DERG) über TLS 1.3 (IEC 62351‑3) an die DER‑Gateways zu senden; jede Operation benötigt ein ‘ControlACK’ ≤ 1 s, andernfalls Retransmit.                                                                                                                                                                                                                    | IEC 61850‑7‑420; IEC 62351‑3; TR‑03109‑5; SGCG ProcMgmt UC                             |
| SGCG – DER process management with reduced power output           | Zur Leistungsreduktion muss der Kommunikations‑Simulator CLS ‘TargetPower’‑Nachrichten mit Limit‑Tag (e.g. 70 % Pmax) CMS‑signiert via TLS 1.3 an die DER‑Gateways verteilen; mindestens 95 % der Gateways müssen innerhalb 3 s eine Limit‑ACK liefern.                                                                                                                                                                                          | IEEE 2030.5; OpenADR 2.0b; IEC 62351‑3; TR‑03109‑1; SGCG PerfMgmt UC                   |
| SGCG – EEG §9 Steuerung von Erzeugern                             | Bei Netzüberlastung muss der Kommunikations‑Simulator eine Leistungsbegrenzung auf 70 % Pmax gemäß BDEW‑Lastmanagementprofil V3.0 als CLS ‘LoadReduction’ CMS‑signiert via TLS 1.3 an EEG‑Anlagen‑Gateways senden; ACK‑Frist 30 s, sonst Wiederholversand bis 3×.                                                                                                                                                                                | IEC 63110; IEC 62351‑14; TR‑03109‑5; SGCG VPP Reg UC                                   |
| SGCG – DER‑Management via DR‑Programm                             | Demand‑Response‑Events (OpenADR 2.0b ‘oadrDistributeEvent’) müssen CMS‑signiert über TLS 1.3 an das lokale EMS‑Gateway gesendet und binnen 2 s mit ‘oadrCreatedEvent’ bestätigt werden; das EMS generiert CLS ‘TargetPower’‑ oder ‘LoadReduction’‑Nachrichten, die der Kommunikations‑Simulator CMS‑signiert über dieselbe TLS‑Session an die DER‑Gateways weiterleitet und ≥95 % ACKs ≤3 s verifiziert.                                         | OpenADR 2.0b; TR‑03109‑5; IEC 62351‑3; SGCG DR UC                                      |
| SGCG – DER & EVSE‑Management zur Eigenverbrauchsoptimierung       | PV‑Erzeugungs‑, Batterie‑SOC‑ und EV‑Ladeleistungs‑Daten sind alle 30 s als IEEE 2030.5 ‘MeterReading’ CMS‑signiert via HTTPS‑TLS 1.3 an den Prosumer‑Controller zu übertragen; dieser sendet kombinierte Self‑Consumption‑Schedules als IEEE 2030.5 ‘DERControl’ und IEC 63110 ‘SetChargingProfile’, die der Simulator binnen 2 s an PV‑, Battery‑ und EVSE‑Gateways verteilt und alle ‘ChargingStatusACK’ bzw. ‘DERControlAck’ ≤1 s überprüft. | IEEE 2030.5; IEC 63110; IEC 62351‑3; TR‑03109‑5; SGCG Self‑Consumption UC              |
## Protecting the Grid Assets

| Use-Case                                                  | Anforderung                                                                                                                                                                                                                                                                                                                | Quellen                                                                    |
| --------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| ORNL – F7 Microgrid‑Protection                            | Schutz‑Relais‑Einstellungen müssen als IEC 61850‑MMS ‘SetDataValues’ (LN SPTR/PDIS) CMS‑signiert über TLS 1.3 (IEC 62351‑3) an die IED‑Gateways gesendet werden; nach Konfig‑ACK erzeugt der Simulator Prüf‑GOOSE (0x88B8) und verifiziert, dass Trip‑Frames ≤4 ms ankommen, um Isolation des Mikronetzes sicherzustellen. | IEC 61850‑8‑1; IEC 62351‑3/6; ORNL µGrid F7; IEEE Std C37.90‑5             |
| SGCG – Capture, expose & analyse disturbance events       | Störereignisse (Voltage Sag, ROCOF) sind als COMTRADE 2013 ZIP CMS‑signiert via SFTP‑TLS 1.3 an den Disturbance‑Datenpool zu übertragen; gleichzeitig sendet der Simulator IDS‑Syslog (RFC 5424) an das SOC und muss eine 200‑OK‑HTTP‑ACK des Analyse‑Backends ≤5 s verifizieren.                                          | IEC 60255‑24 COMTRADE; RFC 5424 Syslog; IEC 62351‑7; SGCG Disturbance UC   |
| SGCG – Perform networked protection logic (Intertripping) | High‑Speed‑Intertrip‑Signale sind als IEC 61850‑GOOSE mit StNum/SeqNum‑Increment über redundante VLANs (PRP) zu senden; der Simulator muss TLS‑getunnelte GOOSE nach IEC 62351‑6 bereitstellen und ≤10 ms End‑to‑End‑Trip‑Bestätigungen verifizieren.                                                                      | IEC 61850‑8‑1/90‑4; IEC 62351‑6; IEEE Std C37.94; SGCG Protection Logic UC |
| SGCG – Perform networked security logic (Interlocking)    | Interlocking‑Reihenfolgen sind als IEC 61850‑MMS ‘Operate’ (LN CSWI) CMS‑signiert via TLS 1.3 an Feld‑IEDs zu senden; lokale Rückmeldungen kommen als GOOSE‑Blocking‑Frames, die der Simulator innerhalb 20 ms korrelieren und eine ‘SecurityACK’ an das DMS sendet.                                                       | IEC 61850‑7‑2/CSWI; IEC 62351‑3/6; SGCG Security Logic UC                  |
| SGCG – Protect a zone outside substation boundary         | Der Kommunikations‑Simulator muss Distanzschutz‑GOOSE‑Frames (LN PDIS) TLS‑getunnelt über IEC 61850‑90‑5 Routable GOOSE an Remote‑IEDs außerhalb der Umspannwerksgrenze senden und ≤20 ms Trip‑Confirm verifizieren.                                                                                                       | IEC 61850‑90‑5; IEC 62351‑5/6; SGCG Out‑of‑Substation UC                   |
| SGCG – Set / change protection parameters                 | Parameter‑Änderungen sind als IEC 61850‑MMS ‘SettingGroupSelect’ CMS‑signiert via TLS 1.3 an Schutz‑IEDs zu schreiben; jede Setting‑ACK muss ≤1 s verarbeitet werden und ein Event‑Log wird via IEC 61850 ‘LogControl’ an das Historian gesendet.                                                                          | IEC 61850‑7‑3/8‑1; IEC 62351‑3; SGCG SetProtection UC; TR‑03109‑1          |

## System and Security Management

| Use-Case                                                   | Anforderungen                                                                                                                                                                                                                                                                                                                          | Quellen                                                                        |
| ---------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |
| PAP13 – Harmonization of IEEE C37.118 with IEC 61850 & PTP | Der Kommunikations‑Simulator muss Synchrophasor‑Daten (IEEE C37.118.2) in IEC 61850‑90‑5 Routable‑SV‑Container wrappen, CMS‑signiert via UDP/TLS 1.3 (IEC 62351‑5) transportieren und mithilfe PTP IEEE 1588‑2008 (Class C, ±1 µs) Zeitstempel synchronisieren; Datei‑Baselines sind via MMS ‘FileDirectory’ abrufbar.                 | IEEE C37.118.2; IEC 61850‑90‑5; IEC 62351‑5; IEEE 1588‑2008; PAP13 Spec        |
| Synchro‑Phasor Monitoring                                  | Alle 33 ms müssen Phasor‑Data‑Frames (30 fps) CMS‑signiert via IEC 61850‑90‑5 Stream an das WAMS‑Backend gesendet und ‘Command Frame’‑ACKs ≤150 ms verifiziert werden; Bulk‑Abfragen historischer Frames erfolgen als COMTRADE über SFTP‑TLS 1.3.                                                                                      | IEEE C37.118.2; IEC 61850‑90‑5; IEC 60255‑24 COMTRADE; IEC 62351‑5; TR‑03109‑1 |
| WAMAC – Emergency Operations Baseline                      | Bei Netzfehlern muss der Kommunikations‑Simulator Fault‑Location‑GOOSE (LN PDIS) innerhalb 20 ms TLS‑getunnelt an das WAMAC‑System senden, gleich­zeitig automatische Load‑Shedding‑Befehle (OpenADR 2.0b ‘LoadShed’) CMS‑signiert via TLS 1.3 verteilen und digitale Fehler­aufzeichnungen (COMTRADE) binnen 60 s per SFTP hochladen. | IEC 61850‑GOOSE; IEC 62351‑6; OpenADR 2.0b; IEC 60255‑24; WAMAC Emergency Spec |


## Ueberschneidungen
| **Gemeinsame Anforderungsschablone**                                                    | Typische Formulierung (verkürzt)                                                          | **Doppelt bzw. identisch verwendet in …**                                                                                                                                                                                               |
| --------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **A. „CMS-signierte Nutzlast über TLS 1.2/1.3 mit beidseitiger SM-PKI-Auth“**           | _„<Message> CMS-signiert via TLS 1.2/1.3 (mutual authentication) an Backend senden.“_     | Fast alle Use-Cases (Configure device, Discovery, Generation Forecast, alle Control- und Grid-Stability-Fälle, Load-Shedding, Redispatch 2.0, §14a SE etc.). → Das ist die **Basis-Transportanforderung** jeder TR-03109-Kommunikation. |
| **B. CLS-ControlMessage: `TargetPower` / `LoadReduction` + Gateway-ACK ≤ x s**          | _„CLS-Nachricht CMS-signiert senden; Gateway muss ≤ 2–3 s quittieren, sonst Retransmit.“_ | NEDO-C2, DER remote control, Feeder load balancing, §14a-SE, Load-Shedding, Redispatch 2.0. Unterschied oft nur in Timeout (1 s vs 3 s) – fachlich identisch.                                                                           |
| **C. IEC 61850-GOOSE (+ TLS-Tunnel IEC 62351-6) mit Retransmit ≤ 10–20 ms**             | _„GOOSE-Trip/Operate versenden; verlorene Frames alle x ms erneut senden.“_               | Switch / Breaker control, FLISR, Voltage Security, Supporting reclosing sequence. → Gleicher Mechanismus, nur unterschiedliche Auslöser.                                                                                                |
| **D. Synchrophasor-Streaming (IEEE C37.118 Data + Command Frames über 61850-90-5/TLS)** | _„PMU-Data Frames @ 30–60 fps übertragen; Command-ACK ≤ 150 ms.“_                         | IP-1 (ISO WAMS), ORNL F1 Frequency Control. → Inhalt, Frame-Rate variieren leicht, Protokoll-Stack identisch.                                                                                                                           |
| **E. Geräte-Onboarding & Zertifikats-OCSP-Prüfung**                                     | _„Neues Gerät bleibt ‹untrusted› bis Cert OCSP-validiert & 1. InfoReport erfolgreich.“_   | Configure newly discovered device, Discover new component (SGCG), Änderungs-Discovery in Control-Cluster.                                                                                                                               |
| **F. Mehrstufige Priorisierung / Arbitration (P0 lokal > Px remote)**                   | _„Befehle mit Prior-Tag sortieren, nur höchsten weiterleiten, Reject für Rest.“_          | Enable multiple concurrent levels of control + sämtliche CLS-Arbiter-Szenarien.                                                                                                                                                         |
| **G. Multicast-ähnliche Distribution an Gateway-Gruppe mit ≥ 95 % ACK**                 | _„Befehl an Gateway-Gruppe senden, 95 % ACK ≤ 3 s, sonst Wiederholung.“_                  | Feeder load balancing, Load-Shedding.                                                                                                                                                                                                   |

### Fazit
- **A** ist das **generische Transport-Grundgerüst** – einmal sauber definiert, gilt es für 90 % aller Anforderungen.
- **B**, **C**, **D** und **E** sind **wiederkehrende Funktionsblöcke**, die du als Template implementieren und nur mit Use-Case-spezifischen Parametern (Timeout, Frame-Rate, Payload-Typ) instanziieren musst.
- **F** und **G** sind Spezialmuster, die zwar weniger Use-Cases betreffen, aber ebenfalls jeweils identisch aufgebaut sind.
- 