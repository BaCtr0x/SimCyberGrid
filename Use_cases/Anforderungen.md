
## Monitoring the Grid  Flows

| Use-Case                           | Kommunikationssimulator                                                                                                                                                                                                                                                                                                     | Netzsimulator                                                                                                                                                                                                                                                          | Co-Simulator                                                                                                                                                                                                                                                              | Testfaelle                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Assets                                                                                                                                               | Threats                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ---------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Data Acquisition and Control (DAC) | Jeder vom Netz-Simulator erzeugte Messwert muss vom Kommunikaiontssimluator als InfoReport nach dem von TR-03109/FNN vorgegeben XML- oder JSON-Schema welches CMS-signiert ist ueber einen TLS-1.2/1.3-Kanal an das VNB-Backend uebertragen werden. Dabei muessen beide Seiten des TLS Kanals zertifikatauthentisiert sein. |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           | Im positiven Testfall, wird während eines 15-minütigen Betriebs mit nominalen Netzbedingungen jede Sekunde ein vom Stromnetz-Simulator berechneter InfoReport durch den Kommunikations-Simulator CMS-signiert und über einen TLS-1.2/1.3-Kanal mit beidseitiger Zertifikatsauthentisierung an das VNB-Backend übertragen. Dabei wird dieser schema-valide geparst und auf Korrektheit nach TR-03109 überprüft.<br><br>Im konkreten Negativ-Test ‚Schema-Verletzung‘ entfernt das Skript das Pflichtfeld unit aus einem InfoReport, injiziert den manipulierten Frame über denselben TLS-Kanal und erwartet, dass das SMGW den Frame verwirft, mit HTTP 400 Bad Request antwortet und den passenden FNN Fehlercode im zentralen Log protokolliert. | Smart Meter Gateway<br><br>CLS-Management Kommunikationsnetwerke<br><br>SCADA-System<br><br>Backende-System<br><br>Zertifkate und Schluesselmaterial | Manipulation von Messdaten (z.B. Man-in-the-Middle)<br><br>Replay-Attacken (Wiederholung von alten Messwerten)<br><br>Denial of Service (DoS) (z.B. Überflutung der Kommunikationsschnittstellen)<br><br>Manipulation von Steuerbefehlen (bei CLS-Management)<br><br>Unbefugter Zugriff auf Steuerfunktionen (Befehle absetzen)<br><br>Abgreifen sensibler Messdaten (Verletzung der Vertraulichkeit)<br><br>Missbrauch von Zertifikaten (z.B. Dienbstahl von privaten Schlüsseln) |
| SCADA Data Update                  | Jeder vom SCADA‑Backend kommende CLS/EMS‑Steuerbefehl muss vom Kommunikations‑Simulator gemäß TR‑03109‑5 in einem CMS‑signierten Control‑Message‑Container empfangen, auf Schema‑ und Signatur­gültigkeit geprüft und innerhalb von 500 ms an die Co‑Simulation übergeben werden.                                           | Der Stromnetz‑Simulator muss alle berechneten Spannungs‑, Strom‑, Leistungs‑ und Frequenzwerte mit zugehöriger OBIS‑Kennung und Einheit bereitstellen, damit der Kommunikations‑Simulator sie direkt in InfoReports einbetten kann (FNN Mikroprozesse, InfoReport‑DS). | Für jeden 1‑s‑Zeitschritt muss die Co‑Simulation erst den Stromnetz‑Simulator verarbeiten, dann den Kommunikations‑Simulator triggern und alle Ereignisse (InfoReport‑ID, Steuerbefehl, Netz‑Event) mit UTC‑Zeitstempel in einem gemeinsamen Log (CEF/JSON) persistieren. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                                    |                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                                    |                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

## Controlling the Grid

| Use-Case                                                                               | Anforderung                                                                                                                                                                                                                                   |
| -------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| NEDO – C1 Hierarchical Control of DMS                                                  | Micro‑DMS,Hierarchische Steuerbefehle (IEC 61850‑MMS 'Operate'‑Service) müssen CMS‑signiert über TLS‑1.2/1.3 mit SM‑PKI‑Client‑Auth vom übergeordneten DMS an Mikro‑DMS‑Gateways weitergeleitet werden                                        |
| NEDO – C2 Hierarchical Control of EMS, EVECC, DMS & ¼‑DMS                              | Aggregations‑Setpoints sollen als CLS‑ControlMessages gemäß TR‑03109‑5 'TargetPower' an alle beteiligten EMS‑Gateways übermittelt werden; die Session muss TLS‑1.3 Session‑Resumption nutzen                                                  |
| PAP08 – Distribution Grid Management (ADA) Functions                                   |                                                                                                                                                                                                                                               |
| Wide‑Area Monitoring & Control - Automated Control Functions                           | Synchrophasor‑basierte Steuersignale (IEEE C37.118.2 'Command Frame') sind in einem CMS‑Container zu verpacken und via TLS‑1.3 mit 256‑bit ECDHE an das SCADA‑WAMS‑Backend zu übertragen                                                      |
| Steuerung von Steuerbaren Verbrauchseinrichtung vom Verteilnetzbereiber nach §14a EnWG | Lastreduktions‑Befehle für steuerbare Verbrauchs­einrichtungen (SE) müssen als CLS‑LoadReduction gemäß BDEW‑Lastmanagementprofil V3.0 gesendet, CMS‑signiert und vom Kunden‑Gateway bestätigt werden; fehlende Bestätigung → Wiederholversand |
| Engpassmanagement (Redispatch 2.0)                                                     | Redispatch‑2.0‑Einspeise­vorgaben (XML‑Format nach BK6‑20‑061) sind als 'RedispatchSetPoint'‑Information an alle betroffenen Erzeuger‑Gateways binnen via TLS-1.3 zuzustellen                                                                 |
| SGCG - DER remote control (dispatch)                                                   | Der Kommunikations‑Simulator muss P/Q‑Dispatch‑Setpoints via CLS‑'TargetPower' an DER‑Gateways senden, CMS‑signiert, TLS‑1.2/1.3 gesichert; Gateway‑Quittung ist innerhalb 2 s zu prüfen.                                                     |
| SGCG - Supporting reclosing sequence                                                   | Für Wiedereinschalt­vorgänge sind zeitgestaffelte 'BreakerClose'‑Befehle (IEC 61850‑CSWI) mit Millisekunden‑Zeitmarken zu übertragen; die Sequenz muss innerhalb einer einzigen TLS‑Session bestätigt werden.                                 |
| SGCG - Supporting source switching                                                     | Umschaltbefehle für Versorgungspunkte sind als IEC 61850‑MMS‑Service 'Select‑Before‑Operate' CMS‑signiert zu übertragen; maximale Umschaltverzögerung 200 ms.                                                                                 |
| SGCG - Discover a new component in the system                                          | Bei Discovery eines neuen Steuerknotens muss der Kommunikations‑Simulator ein 'ControlCapability'‑Dokument (FNN‑Mikroprozesse /capability) abrufen, OCSP‑validieren und innerhalb von 60 s in die Steuer‑Whitelist eintragen.                 |
| SGCG - Enable multiple concurrent levels of control (local-remote)                     | Befehle müssen ein Prioritäts‑Tag (local=P0, remote=Px) enthalten; der Kommunikations‑Simulator hat gemischte Befehls­ströme nach TR‑03109‑5 Arbiter‑Regel (höhere Priorität gewinnt) zu sortieren und nur den finalen Befehl weiterzuleiten. |
| SGCG - Feeder load balancing                                                           | Lastumschalt‑Befehle ('ChangeFeeder') sind als CLS‑'SwitchLoad' an alle relevanten Gateways in einem einzigen Multicast‑ähnlichen TLS‑1.3‑Stream zu übertragen; 95 % der Gateways müssen innerhalb von 3 s quittieren.                        |
| SGCG- Switch/breaker control                                                           | Direkte Schaltbefehle an Leistungsschalter sind als IEC 61850 GOOSE‑Frame mit 'StNum/SeqNum'‑Increment zu versenden; der Kommunikations‑Simulator muss verlorene Frames max. alle 10 ms erneut ausgeben, bis eine Bestätigung eintrifft.      |
